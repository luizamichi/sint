{% extends 'sgc/base.html' %}

{% set page = 'registros' %}

{% block title %}{{ super() }} - Registros{% endblock %}

{% block content %}
	<h1 class="my-3">
		<i class="fas fa-history fa-lg"></i>
		Registros
	</h1>

	{% if not tupla %}
	<!-- Formulário de Consulta -->
	<form action="{{ url_for('sgc.registros') }}" method="get">
		<div class="align-items-center form-row">
			<div class="col-lg-3 col-md-6">
				<label class="sr-only" for="input-pesquisa">Pesquisa</label>
				<div class="input-group mb-2">
					<div class="input-group-prepend">
						<div class="input-group-text">
							<i class="fas fa-search"></i>
						</div>
					</div>
					<input class="form-control" id="input-pesquisa" name="pesquisa" min="1" required type="number">
					<select class="custom-select mr-sm-2" id="input-tipo" name="tipo">
						<option selected value="id">ID</option>
						<option value="ip">IP</option>
						<option value="descricao">Descrição</option>
						<option value="data">Data</option>
					</select>
				</div>
			</div>
			<div class="col-auto">
				<button class="btn btn-block btn-dark mb-2" type="submit">Procurar</button>
			</div>
		</div>
	</form>
	<!--/ Formulário de Consulta -->
	{% endif %}

	{% if get_flashed_messages() %}
	<div class="text-center mt-3">
		<div class="alert alert-{{ get_flashed_messages()[0] }}" role="alert">{{ get_flashed_messages()[1] }}</div>
	</div>
	{% endif %}

	{% if tuplas %}
	<!-- Tabela de Registros -->
	<table class="table table-striped">
		<caption></caption>
		<thead>
			<tr>
				<th scope="col">ID</th>
				<th scope="col">IP</th>
				<th scope="col">Descrição</th>
				<th scope="col">Usuário</th>
				<th scope="col">Data - Hora</th>
			</tr>
		</thead>
		<tbody>
			{% for tupla in tuplas %}
			<tr>
				<th scope="col">{{ tupla.id }}</th>
				<td>{{ tupla.ip }}</td>
				<td>{{ tupla.descricao }}</td>
				<td>{{ tupla.usuario.nome }}</td>
				<td>{{ tupla.data.strftime('%d/%m/%Y - %H:%M:%S') }}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
	<!--/ Tabela de Registros -->
	{% endif %}

	{% if paginas %}
		{% include 'sgc/navegador.html' %}
		{% include 'sgc/modal.html' %}
	{% endif %}

{% endblock %}